function initialize(){load_state_from_query_string(),prepare_event_listeners()}function reset_state(){rewrite_query_string_in_url(""),load_state_from_query_string()}function load_state_from_query_string(){load_input_field_contents_from_query_string(),refresh_cells_dict_from_input_fields(),refresh_output_list_from_cells_dict()}function prepare_event_listeners(){g_reset_button.addEventListener("click",reset_state),Object.values(g_input_fields).forEach(function(a){a.addEventListener("keyup",function(){input_field_event(a)})})}function refresh_cells_dict_from_input_fields(){Object.values(g_input_fields).forEach(function(a){var b=input_field_to_cell(a);g_cells[b.id]=b})}function input_field_event(a){var b=input_field_to_cell(a);g_cells[b.id]=b,refresh_output_list_from_cells_dict(),refresh_query_string_from_cells_dict()}function input_field_to_cell(a){var b={id:a.name,value:parseInt(clean_string(a.value)),is_valid:function(){return!isNaN(this.value)}};return b}function clean_string(a){return a=a.replace(/[&]nbsp[;]/gi,""),a=a.replace(/[<]br[^>]*[>]/gi,""),a.trim()}function refresh_output_list_from_cells_dict(){g_output_list_element.innerHTML=cells_to_sorted_html_list(g_cells)}function cells_to_sorted_html_list(a){var b="",c=cells_dictionary_to_sorted_array(a);return Object.values(c).forEach(function(a){b+=cell_to_html_list_element(a)}),b}function cells_dictionary_to_sorted_array(a){var b=[];return Object.values(a).forEach(function(a){a.is_valid()&&b.push(a)}),b.sort(cell_sorter),b}function cell_sorter(a,b){var c=b.value-a.value;return 0===c&&(c=a.id.localeCompare(b.id)),c}function cell_to_html_list_element(a){return"<li>"+a.id+": "+a.value+"</li>"}function load_input_field_contents_from_query_string(){Object.values(g_input_fields).forEach(function(a){var b=read_query_string_field(window.location.search,a.name);a.value=null!=b?b:""})}function read_query_string_field(a,b){var c=new RegExp("[?&]"+b+"=(.*?)(&|$)","i"),d=a.match(c);return null==d?null:d[1]}function refresh_query_string_from_cells_dict(){Object.values(g_cells).forEach(function(a){save_cell_to_query_string(a)})}function save_cell_to_query_string(a){var b;b=null!=a&&a.is_valid()?update_query_string_field(window.location.search,a.id,a.value):remove_query_string_field(window.location.search,a.id),rewrite_query_string_in_url(b)}function update_query_string_field(a,b,c){var f,d=new RegExp("([?&])"+b+"=[^&]*","i"),e=-1!==a.indexOf("?")?"&":"?";return f=a.match(d)?a.replace(d,"$1"+b+"="+c):a+e+b+"="+c}function remove_query_string_field(a,b){var e,c=new RegExp("[?]"+b+"=[^&]*&?","i"),d=new RegExp("&"+b+"=[^&]*","i");return e=a.match(c)?a.replace(c,""):a.match(d)?a.replace(d,""):a}function rewrite_query_string_in_url(a){var b=new URL(window.location.href);b.search=a,window.history.replaceState(null,document.title,b.href)}var g_output_list_element=document.getElementById("sorted_list"),g_input_fields=document.getElementsByClassName("cell"),g_reset_button=document.getElementById("reset_button"),g_cells={};initialize();
